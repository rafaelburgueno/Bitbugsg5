{% extends 'core/base.html' %}
{% load static %}
{% block title %}Pedidos Farmacia{% endblock %}
{% block content %}

{% comment %} {% include 'pedidos/includes/pedidos_menu.html' %} {% endcomment %}

<main role="main">
  <div class="container mb-4">

    {% comment %}
    Mensaje de confirmacion por una edicion exitosa
    {% endcomment %}
    {% if request.GET %}
      <div class="alert alert-success alert-dismissible fade show desvanecer" role="alert">
        {% if 'procesado' in request.GET %}
          El pedido fue procesado correctamente.
        {% elif 'borrado' in request.GET %}
          El pedido fue borrado correctamente.
        {% endif %}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
    
    {% endif %}


    {% comment %} las siguientes 'pipes' le dice que campo usar para ordenar los resultados(por urgencia y en reversa: '|dictsort:"urgencia" reversed ') {% endcomment %}
    {% for pedido in pedidos_list %}

      <div class="card text-white bg-info mb-5 shadow-lg" >
        <form>
          <div class="card-header">
            {% comment %} <a href="{% url 'pedidos:pedido' pedido.id %}" style="color:white;"> {% endcomment %}
            
            
            {% comment %} 
            Visualiza la urgencia del pedido (rutina, urgente)
            {% endcomment %}
            {% if pedido.urgencia == 'no urgente' %}
              <span class="badge badge-success float-left">Rutina</span>
            {% elif pedido.urgencia == 'urgente' %}
              <span class="badge badge-danger float-left">Urgente</span>
            {% else %}
              <span class="badge badge-warning float-left">Modificado</span>
            {% endif %}


            {% comment %} 
            Visualizar el estado del pedido (pendiente, en proceso o para retirar)
            {% endcomment %}
            {% if pedido.estado == 'pendiente' %}
            <span class="badge badge-danger float-right">{{pedido.estado}}</span>
            {% elif pedido.estado == 'en proceso' %}
            <span class="badge badge-warning float-right">{{pedido.estado}}</span>
            {% elif pedido.estado == 'para retirar' %}
            <span class="badge badge-success float-right">{{pedido.estado}}</span>
            {% endif %}


            {% comment %}
            Visualiza el id del pedido (podria ocultarse, no es muy relevante)
            {% endcomment %}
            <p class="text-center"><span class="badge badge-pill badge-light">id:{{pedido.id}}</span></p>


            {% comment %}
            Visualiza la sala, la cama y el nombre del paciente
            {% endcomment %}
            <h4 class="text-center mt-3">{{pedido.cama}} - {{pedido.paciente}}</h4>

          </div>
            
          <div class="card-body">

            <ul class="list-group text-dark mb-3">
              {% for insumo in pedido.insumos_as_list %}
                <li class="list-group-item">{{insumo}}</li>
              {% endfor %}
            </ul>

            <p class="">Solicitado por: {{pedido.solicitante}} - {{pedido.created}}</p>
            <p class="">Procesado por: {{pedido.procesante}} - {{pedido.fecha_procesamiento}}</p>
            <p class="">Despachable: {{pedido.fecha_despachable}}</p>
            <p class="">Retirado por: {{pedido.retirante}} - {{pedido.fecha_despacho}}</p>

            
            <a href="{% url 'pedidos:procesar' pedido.id %}" class="btn btn-block btn-outline-light">Procesar</a>
                        
            <a href="{% url 'pedidos:delete' pedido.id %}" class="btn btn-block btn-outline-warning">Borrar</a>


            

            {% comment %} <p class="card-text">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Orci varius natoque et magnis dis, nascetur ridiculus mus.
            </p> {% endcomment %}
            
          </div>

        </form>

      </div>


    {% endfor %}
  </div>
</main>
{% endblock %}




